[tox]
envlist = py25, py26, py27, py32
[testenv]
deps =
    pytest

    # Third party modules (used in test/completion/thirdparty/)
    django
    # psycopg2
    # PyQt4

    # Workaround the issue with matplotlib installation.  Numpy must be
    # installed here because its installation must be done before
    # installing matplotlib:
    numpy
commands =
    # See above for why we need to install matplotlib here:
    pip install --use-mirrors --quiet matplotlib --log /dev/null

    py.test {posargs:--thirdparty}
    # Doctests can't be run with the main tests because then py.test
    # tries to import broken python files under test/*/.
    py.test --doctest-modules {toxinidir}/jedi
[testenv:py25]
deps =
    simplejson
    unittest2
    {[testenv]deps}
[testenv:py26]
deps =
    unittest2
    {[testenv]deps}
[testenv:py32]
# TODO: Without this setting, test uses ~/.cache/jedi/.
#       There could be a bug due to import hack.
#       See test_settings_module in test/test_regression.py.
setenv =
    XDG_CACHE_HOME={envtmpdir}/cache
